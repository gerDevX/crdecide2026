---
---

<div id="mode-selector-modal" class="hidden">
  <!-- Animated Background -->
  <div class="modal-backdrop animated-gradient-bg" id="mode-selector-backdrop"></div>
  
  <!-- Floating Particles -->
  <div class="particles-container">
    <div class="particle particle-1"></div>
    <div class="particle particle-2"></div>
    <div class="particle particle-3"></div>
    <div class="particle particle-4"></div>
    <div class="particle particle-5"></div>
  </div>
  
  <div class="modal-content glass-modal p-6" role="dialog" aria-modal="true" aria-labelledby="mode-selector-title">
    
    <!-- Header with animated gradient text -->
    <div class="text-center mb-6">
      <div class="logo-container mb-4">
        <div class="logo-ring"></div>
        <span class="logo-emoji">üó≥Ô∏è</span>
      </div>
      <h2 id="mode-selector-title" class="text-3xl font-bold gradient-text-animated mb-3">
        ¬°Costa Rica Decide!
      </h2>
      <div class="flex items-center justify-center gap-2">
        <p class="text-lg text-slate-600">¬øEn cu√°l rango est√° tu edad?</p>
        <button 
          id="info-tooltip-btn"
          class="info-btn w-7 h-7 bg-civic-100 hover:bg-civic-200 rounded-full flex items-center justify-center text-civic-600 hover:text-civic-700 transition-all text-sm font-bold"
          aria-label="¬øPor qu√© preguntamos esto?"
        >?</button>
      </div>
      
      <!-- Tooltip with animation -->
      <div id="info-tooltip" class="hidden tooltip-animated mt-3 bg-slate-900 text-white text-sm rounded-xl p-4 text-left max-w-sm mx-auto shadow-2xl">
        <p class="font-medium mb-2 flex items-center gap-2">
          <span class="w-6 h-6 bg-cyan-500 rounded-full flex items-center justify-center text-white text-xs">üí°</span>
          ¬øPor qu√© preguntamos?
        </p>
        <p class="text-slate-300 text-xs leading-relaxed">
          Adaptamos la experiencia seg√∫n tu necesidad. 
          Esto <strong class="text-white">no afecta el contenido</strong>, solo c√≥mo lo ves.
        </p>
      </div>
    </div>

    <!-- Age Options with Magic UI effects -->
    <div class="space-y-4">
      
      <!-- 18-35 -->
      <button
        data-age="18-35"
        data-mode="express"
        class="age-option group"
      >
        <div class="flex items-center gap-4">
          <div class="w-14 h-14 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-xl flex items-center justify-center flex-shrink-0 shadow-lg group-hover:scale-110 transition-transform">
            <span class="text-2xl">üöÄ</span>
          </div>
          <div class="flex-1 text-left">
            <div class="flex items-center gap-2">
              <span class="text-lg font-bold text-slate-900 group-hover:text-civic-600">18-35 a√±os</span>
              <span class="text-xs bg-cyan-100 text-cyan-700 px-2 py-0.5 rounded-full font-medium">Express</span>
            </div>
            <p class="text-sm text-slate-500 mt-1">
              <strong class="text-slate-700">R√°pido y visual</strong> ‚Äî Interfaz t√°ctil optimizada para m√≥vil, 
              desliza entre candidatos como en redes sociales.
            </p>
          </div>
          <svg class="w-5 h-5 text-slate-300 group-hover:text-civic-500 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
          </svg>
        </div>
        <div class="mt-3 pt-3 border-t border-slate-100">
          <div class="flex items-center gap-4 text-xs text-slate-400">
            <span class="flex items-center gap-1">‚ú® Animaciones</span>
            <span class="flex items-center gap-1">üì± M√≥vil primero</span>
            <span class="flex items-center gap-1">üëÜ Gestos t√°ctiles</span>
          </div>
        </div>
      </button>

      <!-- 36-49 -->
      <button
        data-age="36-49"
        data-mode="dashboard"
        class="age-option group"
      >
        <div class="flex items-center gap-4">
          <div class="w-14 h-14 bg-gradient-to-br from-slate-600 to-slate-800 rounded-xl flex items-center justify-center flex-shrink-0 shadow-lg group-hover:scale-110 transition-transform">
            <span class="text-2xl">üìä</span>
          </div>
          <div class="flex-1 text-left">
            <div class="flex items-center gap-2">
              <span class="text-lg font-bold text-slate-900 group-hover:text-civic-600">36-49 a√±os</span>
              <span class="text-xs bg-slate-100 text-slate-600 px-2 py-0.5 rounded-full font-medium">Dashboard</span>
            </div>
            <p class="text-sm text-slate-500 mt-1">
              <strong class="text-slate-700">Completo y detallado</strong> ‚Äî Tablas comparativas, 
              rankings, filtros y toda la informaci√≥n a un vistazo.
            </p>
          </div>
          <svg class="w-5 h-5 text-slate-300 group-hover:text-civic-500 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
          </svg>
        </div>
        <div class="mt-3 pt-3 border-t border-slate-100">
          <div class="flex items-center gap-4 text-xs text-slate-400">
            <span class="flex items-center gap-1">üìã Tablas</span>
            <span class="flex items-center gap-1">üîç Filtros</span>
            <span class="flex items-center gap-1">üìà Gr√°ficos</span>
          </div>
        </div>
      </button>

      <!-- 50+ -->
      <button
        data-age="50+"
        data-mode="reading"
        class="age-option group"
      >
        <div class="flex items-center gap-4">
          <div class="w-14 h-14 bg-gradient-to-br from-amber-500 to-orange-600 rounded-xl flex items-center justify-center flex-shrink-0 shadow-lg group-hover:scale-110 transition-transform">
            <span class="text-2xl">üìñ</span>
          </div>
          <div class="flex-1 text-left">
            <div class="flex items-center gap-2">
              <span class="text-lg font-bold text-slate-900 group-hover:text-civic-600">50+ a√±os</span>
              <span class="text-xs bg-amber-100 text-amber-700 px-2 py-0.5 rounded-full font-medium">Lectura</span>
            </div>
            <p class="text-sm text-slate-500 mt-1">
              <strong class="text-slate-700">Claro y c√≥modo</strong> ‚Äî Texto grande, fondo suave para la vista, 
              sin animaciones que distraigan.
            </p>
          </div>
          <svg class="w-5 h-5 text-slate-300 group-hover:text-civic-500 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
          </svg>
        </div>
        <div class="mt-3 pt-3 border-t border-slate-100">
          <div class="flex items-center gap-4 text-xs text-slate-400">
            <span class="flex items-center gap-1">üî† Texto grande</span>
            <span class="flex items-center gap-1">üåÖ Fondo c√°lido</span>
            <span class="flex items-center gap-1">üßò Sin distracciones</span>
          </div>
        </div>
      </button>

    </div>

    <!-- Footer -->
    <div class="mt-6 pt-4 border-t border-slate-100">
      <p class="text-center text-xs text-slate-400">
        üîÑ Puedes cambiar esto en cualquier momento desde el men√∫ superior
      </p>
    </div>

    <!-- Privacy note -->
    <div class="mt-4 text-center">
      <p class="text-xs text-slate-300">
        üîí Esta preferencia se guarda solo en tu dispositivo. No recolectamos datos personales.
      </p>
    </div>
  </div>
</div>

<script>
  const modal = document.getElementById('mode-selector-modal');
  const buttons = document.querySelectorAll('.age-option');
  const tooltipBtn = document.getElementById('info-tooltip-btn');
  const tooltip = document.getElementById('info-tooltip');

  // Check if mode is stored
  const storedMode = localStorage.getItem('costarica-decide-mode');
  const storedAge = localStorage.getItem('costarica-decide-age-group');
  
  if (!storedMode && !storedAge && modal) {
    modal.classList.remove('hidden');
    document.body.style.overflow = 'hidden';
  }

  // Tooltip toggle
  tooltipBtn?.addEventListener('click', (e) => {
    e.stopPropagation();
    tooltip?.classList.toggle('hidden');
  });

  buttons.forEach(btn => {
    btn.addEventListener('click', (e) => {
      const target = e.currentTarget as HTMLElement;
      const age = target.dataset.age;
      const mode = target.dataset.mode;
      
      if (age && mode) {
        // Set age group
        localStorage.setItem('costarica-decide-age-group', age);
        document.documentElement.setAttribute('data-age-group', age);
        
        // Set mode
        localStorage.setItem('costarica-decide-mode', mode);
        document.documentElement.setAttribute('data-mode', mode);
        
        // Close modal
        modal?.classList.add('hidden');
        document.body.style.overflow = '';
        
        // Reload to apply changes
        window.location.reload();
      }
    });
  });
</script>

<style>
  /* Animated Gradient Background - Bandera CR */
  .animated-gradient-bg {
    background: linear-gradient(-45deg, #002b7f, #1d4ed8, #3b82f6, #1d4ed8, #002b7f);
    background-size: 400% 400%;
    animation: gradient-shift 15s ease infinite;
  }
  
  @keyframes gradient-shift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }
  
  /* Floating Particles */
  .particles-container {
    position: fixed;
    inset: 0;
    z-index: 41;
    pointer-events: none;
    overflow: hidden;
  }
  
  .particle {
    position: absolute;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.3);
    animation: float-particle 20s infinite ease-in-out;
  }
  
  .particle-1 { width: 20px; height: 20px; top: 10%; left: 10%; animation-delay: 0s; }
  .particle-2 { width: 15px; height: 15px; top: 20%; right: 15%; animation-delay: 2s; }
  .particle-3 { width: 25px; height: 25px; bottom: 20%; left: 20%; animation-delay: 4s; }
  .particle-4 { width: 10px; height: 10px; bottom: 30%; right: 25%; animation-delay: 6s; }
  .particle-5 { width: 18px; height: 18px; top: 50%; left: 5%; animation-delay: 8s; }
  
  @keyframes float-particle {
    0%, 100% { 
      transform: translate(0, 0) scale(1);
      opacity: 0.3;
    }
    25% { 
      transform: translate(100px, -50px) scale(1.2);
      opacity: 0.5;
    }
    50% { 
      transform: translate(50px, -100px) scale(0.8);
      opacity: 0.2;
    }
    75% { 
      transform: translate(-50px, -50px) scale(1.1);
      opacity: 0.4;
    }
  }
  
  /* Glassmorphism Modal */
  .glass-modal {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px) saturate(180%);
    -webkit-backdrop-filter: blur(20px) saturate(180%);
    border: 1px solid rgba(255, 255, 255, 0.5);
    box-shadow: 
      0 25px 50px -12px rgba(0, 0, 0, 0.25),
      0 0 0 1px rgba(255, 255, 255, 0.5) inset;
    border-radius: 1.5rem;
    animation: modal-enter 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
  }
  
  @keyframes modal-enter {
    from {
      opacity: 0;
      transform: translate(-50%, -50%) scale(0.9);
    }
    to {
      opacity: 1;
      transform: translate(-50%, -50%) scale(1);
    }
  }
  
  /* Logo Animation */
  .logo-container {
    position: relative;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 80px;
    height: 80px;
  }
  
  .logo-ring {
    position: absolute;
    inset: 0;
    border-radius: 50%;
    border: 3px solid transparent;
    background: conic-gradient(from 0deg, #002b7f, #1d4ed8, #ce1126, #002b7f) border-box;
    -webkit-mask: 
      linear-gradient(#fff 0 0) padding-box, 
      linear-gradient(#fff 0 0);
    mask: 
      linear-gradient(#fff 0 0) padding-box, 
      linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    animation: logo-spin 4s linear infinite;
  }
  
  @keyframes logo-spin {
    to { transform: rotate(360deg); }
  }
  
  .logo-emoji {
    font-size: 2.5rem;
    animation: logo-bounce 2s ease-in-out infinite;
  }
  
  @keyframes logo-bounce {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
  }
  
  /* Gradient Text - Bandera CR */
  .gradient-text-animated {
    background: linear-gradient(
      90deg,
      #002b7f 0%,
      #1d4ed8 25%,
      #3b82f6 50%,
      #1d4ed8 75%,
      #002b7f 100%
    );
    background-size: 200% auto;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: text-gradient-move 3s linear infinite;
  }
  
  @keyframes text-gradient-move {
    to { background-position: 200% center; }
  }
  
  /* Info Button */
  .info-btn {
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  }
  
  .info-btn:hover {
    transform: scale(1.2) rotate(15deg);
  }
  
  /* Tooltip Animation */
  .tooltip-animated {
    animation: tooltip-enter 0.3s ease-out;
  }
  
  @keyframes tooltip-enter {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  /* Age Option with Magic Effects */
  .age-option {
    width: 100%;
    padding: 1rem;
    border-radius: 1rem;
    border: 2px solid #e2e8f0;
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    cursor: pointer;
    background: white;
    position: relative;
    overflow: hidden;
  }
  
  .age-option::before {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, rgba(0, 43, 127, 0.05) 0%, transparent 50%, rgba(29, 78, 216, 0.05) 100%);
    opacity: 0;
    transition: opacity 0.3s;
  }
  
  .age-option::after {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: linear-gradient(
      to right,
      transparent 0%,
      rgba(255, 255, 255, 0.5) 50%,
      transparent 100%
    );
    transform: rotate(45deg) translateX(-100%);
    transition: transform 0.6s;
  }
  
  .age-option:hover {
    border-color: #38bdf8;
    transform: translateY(-4px) scale(1.02);
    box-shadow: 
      0 20px 40px -10px rgba(0, 0, 0, 0.15),
      0 0 0 1px rgba(56, 189, 248, 0.3);
  }
  
  .age-option:hover::before {
    opacity: 1;
  }
  
  .age-option:hover::after {
    transform: rotate(45deg) translateX(100%);
  }
  
  .age-option:focus {
    outline: none;
    box-shadow: 0 0 0 3px white, 0 0 0 5px #0ea5e9;
  }
  
  .age-option:active {
    transform: translateY(-2px) scale(1.01);
  }
  
  /* Staggered animation for options */
  .age-option:nth-child(1) { animation: option-enter 0.4s ease-out 0.1s backwards; }
  .age-option:nth-child(2) { animation: option-enter 0.4s ease-out 0.2s backwards; }
  .age-option:nth-child(3) { animation: option-enter 0.4s ease-out 0.3s backwards; }
  
  @keyframes option-enter {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  .modal-content {
    max-height: 95vh;
    overflow-y: auto;
  }
  
  @media (max-width: 640px) {
    .modal-content {
      margin: 0.5rem;
      max-height: 98vh;
    }
    
    .age-option {
      padding: 0.875rem;
    }
    
    .logo-container {
      width: 60px;
      height: 60px;
    }
    
    .logo-emoji {
      font-size: 2rem;
    }
  }
</style>

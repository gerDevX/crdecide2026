---
import BaseLayout from '../layouts/BaseLayout.astro';
---

<BaseLayout 
  title="Detalles T√©cnicos"
  description="Detalles t√©cnicos del sistema de an√°lisis de planes de gobierno. Stack tecnol√≥gico, procesamiento de PDFs, OCR, penalizaciones, bonos y flags informativos. Para desarrolladores."
>
  
  <!-- ============================================
       MODE: DASHBOARD üìä
       ============================================ -->
  <div class="mode-dashboard-content">
  <article class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12 prose prose-slate prose-lg">
    
    <h1 class="flex items-center gap-3">
      <span>‚öôÔ∏è</span> Detalles T√©cnicos del An√°lisis
    </h1>

    <div class="not-prose bg-slate-100 border border-slate-300 rounded-xl p-4 mb-8">
      <p class="text-slate-600 text-sm">
        Esta p√°gina est√° dirigida a personas con conocimientos t√©cnicos que deseen entender 
        c√≥mo funciona el sistema de an√°lisis. Si buscas una explicaci√≥n m√°s general, 
        visita la <a href="/metodologia" class="text-civic-600 hover:underline font-medium">p√°gina de metodolog√≠a</a>.
      </p>
    </div>

    <hr />

    <h2>üêç Stack Tecnol√≥gico</h2>
    
    <div class="not-prose grid md:grid-cols-2 gap-4 mt-4">
      <div class="bg-gradient-to-br from-yellow-50 to-amber-50 border border-amber-200 rounded-xl p-5">
        <div class="flex items-center gap-3 mb-3">
          <span class="text-3xl">üêç</span>
          <div>
            <p class="font-bold text-amber-900 text-lg">Python 3.10+</p>
            <p class="text-sm text-amber-700">Lenguaje principal</p>
          </div>
        </div>
        <p class="text-sm text-slate-600">
          Scripts de procesamiento de PDFs, extracci√≥n de propuestas y c√°lculo de puntajes.
        </p>
      </div>
      
      <div class="bg-gradient-to-br from-orange-50 to-red-50 border border-orange-200 rounded-xl p-5">
        <div class="flex items-center gap-3 mb-3">
          <span class="text-3xl">üöÄ</span>
          <div>
            <p class="font-bold text-orange-900 text-lg">Astro 4.x</p>
            <p class="text-sm text-orange-700">Framework web</p>
          </div>
        </div>
        <p class="text-sm text-slate-600">
          Generador de sitios est√°ticos para la visualizaci√≥n de resultados.
        </p>
      </div>
    </div>

    <hr />

    <h2>üìÑ Procesamiento de PDFs</h2>

    <div class="not-prose space-y-4 mt-4">
      <!-- PyMuPDF -->
      <div class="bg-white border border-slate-200 rounded-xl p-5 shadow-sm">
        <div class="flex items-start gap-4">
          <div class="w-16 h-16 bg-red-100 rounded-xl flex items-center justify-center shrink-0">
            <span class="text-2xl font-bold text-red-600">PDF</span>
          </div>
          <div class="flex-1">
            <div class="flex items-center gap-2 mb-1">
              <h3 class="font-bold text-slate-900 text-lg">PyMuPDF (fitz)</h3>
              <span class="text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded-full">Activo</span>
            </div>
            <p class="text-slate-600 text-sm mb-3">
              Librer√≠a de alto rendimiento para lectura y manipulaci√≥n de documentos PDF.
            </p>
            <div class="bg-slate-50 rounded-lg p-3 font-mono text-sm">
              <code class="text-slate-700">pip install PyMuPDF</code>
            </div>
            <div class="mt-3 text-sm">
              <p class="font-medium text-slate-700 mb-1">¬øPara qu√© se usa?</p>
              <ul class="text-slate-600 space-y-1 list-disc list-inside">
                <li>Extracci√≥n de texto p√°gina por p√°gina</li>
                <li>Detecci√≥n de texto corrupto (fuentes mal embebidas)</li>
                <li>Renderizaci√≥n de p√°ginas como im√°genes para OCR</li>
              </ul>
            </div>
            <a href="https://pymupdf.readthedocs.io/" target="_blank" rel="noopener" 
               class="inline-flex items-center gap-1 mt-3 text-sm text-blue-600 hover:underline">
              üìö Documentaci√≥n oficial ‚Üí
            </a>
          </div>
        </div>
      </div>

      <!-- Tesseract OCR -->
      <div class="bg-white border border-slate-200 rounded-xl p-5 shadow-sm">
        <div class="flex items-start gap-4">
          <div class="w-16 h-16 bg-blue-100 rounded-xl flex items-center justify-center shrink-0">
            <span class="text-2xl">üëÅÔ∏è</span>
          </div>
          <div class="flex-1">
            <div class="flex items-center gap-2 mb-1">
              <h3 class="font-bold text-slate-900 text-lg">Tesseract OCR</h3>
              <span class="text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded-full">v5.5.1</span>
            </div>
            <p class="text-slate-600 text-sm mb-3">
              Motor de reconocimiento √≥ptico de caracteres (OCR) de c√≥digo abierto, mantenido por Google.
            </p>
            <div class="bg-slate-50 rounded-lg p-3 font-mono text-sm space-y-1">
              <code class="text-slate-700 block"># macOS</code>
              <code class="text-slate-700 block">brew install tesseract tesseract-lang</code>
              <code class="text-slate-700 block mt-2"># Ubuntu/Debian</code>
              <code class="text-slate-700 block">apt install tesseract-ocr tesseract-ocr-spa</code>
            </div>
            <div class="mt-3 text-sm">
              <p class="font-medium text-slate-700 mb-1">¬øPara qu√© se usa?</p>
              <ul class="text-slate-600 space-y-1 list-disc list-inside">
                <li>Lectura de PDFs con texto corrupto o escaneado</li>
                <li>Extracci√≥n de texto de im√°genes de p√°ginas</li>
                <li>Soporte multiidioma (espa√±ol configurado)</li>
              </ul>
            </div>
            <a href="https://github.com/tesseract-ocr/tesseract" target="_blank" rel="noopener" 
               class="inline-flex items-center gap-1 mt-3 text-sm text-blue-600 hover:underline">
              üìö Repositorio GitHub ‚Üí
            </a>
          </div>
        </div>
      </div>

      <!-- pytesseract -->
      <div class="bg-white border border-slate-200 rounded-xl p-5 shadow-sm">
        <div class="flex items-start gap-4">
          <div class="w-16 h-16 bg-purple-100 rounded-xl flex items-center justify-center shrink-0">
            <span class="text-2xl">üîó</span>
          </div>
          <div class="flex-1">
            <div class="flex items-center gap-2 mb-1">
              <h3 class="font-bold text-slate-900 text-lg">pytesseract</h3>
              <span class="text-xs bg-purple-100 text-purple-700 px-2 py-0.5 rounded-full">Python wrapper</span>
            </div>
            <p class="text-slate-600 text-sm mb-3">
              Wrapper de Python para Tesseract OCR que facilita su integraci√≥n.
            </p>
            <div class="bg-slate-50 rounded-lg p-3 font-mono text-sm">
              <code class="text-slate-700">pip install pytesseract</code>
            </div>
            <a href="https://pypi.org/project/pytesseract/" target="_blank" rel="noopener" 
               class="inline-flex items-center gap-1 mt-3 text-sm text-blue-600 hover:underline">
              üìö PyPI ‚Üí
            </a>
          </div>
        </div>
      </div>

      <!-- Pillow -->
      <div class="bg-white border border-slate-200 rounded-xl p-5 shadow-sm">
        <div class="flex items-start gap-4">
          <div class="w-16 h-16 bg-emerald-100 rounded-xl flex items-center justify-center shrink-0">
            <span class="text-2xl">üñºÔ∏è</span>
          </div>
          <div class="flex-1">
            <div class="flex items-center gap-2 mb-1">
              <h3 class="font-bold text-slate-900 text-lg">Pillow (PIL)</h3>
              <span class="text-xs bg-emerald-100 text-emerald-700 px-2 py-0.5 rounded-full">Procesamiento de im√°genes</span>
            </div>
            <p class="text-slate-600 text-sm mb-3">
              Fork moderno de Python Imaging Library para manipulaci√≥n de im√°genes.
            </p>
            <div class="bg-slate-50 rounded-lg p-3 font-mono text-sm">
              <code class="text-slate-700">pip install Pillow</code>
            </div>
            <div class="mt-3 text-sm">
              <p class="font-medium text-slate-700 mb-1">¬øPara qu√© se usa?</p>
              <ul class="text-slate-600 space-y-1 list-disc list-inside">
                <li>Conversi√≥n de p√°ginas PDF a im√°genes PNG</li>
                <li>Preparaci√≥n de im√°genes para OCR</li>
              </ul>
            </div>
            <a href="https://pillow.readthedocs.io/" target="_blank" rel="noopener" 
               class="inline-flex items-center gap-1 mt-3 text-sm text-blue-600 hover:underline">
              üìö Documentaci√≥n oficial ‚Üí
            </a>
          </div>
        </div>
      </div>
    </div>

    <hr />

    <h2>‚öôÔ∏è Configuraci√≥n del OCR</h2>

    <div class="not-prose bg-slate-900 rounded-xl p-5 mt-4 overflow-x-auto">
      <pre class="text-sm text-slate-100 font-mono"><code set:text={`# Configuraci√≥n en process_plans_v7.py

# Resoluci√≥n para renderizar p√°ginas como imagen
RENDER_DPI = 200

# Configuraci√≥n de Tesseract
# --psm 1: Automatic page segmentation with OSD
# -l spa: Idioma espa√±ol
TESSERACT_CONFIG = '--psm 1 -l spa'

# Caracteres que indican fuentes corruptas
CORRUPT_CHARS = set([
    '\\uf0b7', '\\uf0a7', '\\uf0d8', '\\uf020', '\\uf06c', 
    '\\uf06f', '\\uf073', '\\uf061', '\\uf065', '\\uf06e',
    # ... m√°s caracteres de fuentes privadas
])

# Umbral: si m√°s del 2% del texto son caracteres corruptos, usar OCR
CORRUPT_THRESHOLD = 0.02`}></code></pre>
    </div>

    <hr />

    <h2>üîÑ Flujo de Procesamiento</h2>

    <div class="not-prose mt-4">
      <div class="relative">
        <!-- Timeline -->
        <div class="absolute left-6 top-0 bottom-0 w-0.5 bg-slate-200"></div>
        
        <div class="space-y-6">
          <div class="relative flex items-start gap-4">
            <div class="w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold z-10 shrink-0">1</div>
            <div class="bg-white border border-slate-200 rounded-xl p-4 flex-1 shadow-sm">
              <h4 class="font-bold text-slate-900">Lectura del PDF</h4>
              <p class="text-sm text-slate-600 mt-1">
                <code class="bg-slate-100 px-1 rounded">fitz.open(pdf_path)</code> abre el documento PDF.
              </p>
            </div>
          </div>
          
          <div class="relative flex items-start gap-4">
            <div class="w-12 h-12 bg-amber-500 rounded-full flex items-center justify-center text-white font-bold z-10 shrink-0">2</div>
            <div class="bg-white border border-slate-200 rounded-xl p-4 flex-1 shadow-sm">
              <h4 class="font-bold text-slate-900">Detecci√≥n de Texto Corrupto</h4>
              <p class="text-sm text-slate-600 mt-1">
                Se muestrean las primeras 10 p√°ginas. Si &gt;2% son caracteres de fuentes privadas, se activa OCR.
              </p>
            </div>
          </div>
          
          <div class="relative flex items-start gap-4">
            <div class="w-12 h-12 bg-purple-500 rounded-full flex items-center justify-center text-white font-bold z-10 shrink-0">3</div>
            <div class="bg-white border border-slate-200 rounded-xl p-4 flex-1 shadow-sm">
              <h4 class="font-bold text-slate-900">Extracci√≥n de Texto</h4>
              <p class="text-sm text-slate-600 mt-1">
                <strong>Modo normal:</strong> <code class="bg-slate-100 px-1 rounded">page.get_text()</code><br>
                <strong>Modo OCR:</strong> Renderiza a imagen ‚Üí Tesseract ‚Üí texto
              </p>
            </div>
          </div>
          
          <div class="relative flex items-start gap-4">
            <div class="w-12 h-12 bg-emerald-500 rounded-full flex items-center justify-center text-white font-bold z-10 shrink-0">4</div>
            <div class="bg-white border border-slate-200 rounded-xl p-4 flex-1 shadow-sm">
              <h4 class="font-bold text-slate-900">B√∫squeda de Propuestas</h4>
              <p class="text-sm text-slate-600 mt-1">
                Se buscan keywords por pilar y se extraen propuestas con contexto.
              </p>
            </div>
          </div>
          
          <div class="relative flex items-start gap-4">
            <div class="w-12 h-12 bg-red-500 rounded-full flex items-center justify-center text-white font-bold z-10 shrink-0">5</div>
            <div class="bg-white border border-slate-200 rounded-xl p-4 flex-1 shadow-sm">
              <h4 class="font-bold text-slate-900">Evaluaci√≥n, Penalizaci√≥n y Bonos</h4>
              <p class="text-sm text-slate-600 mt-1">
                Se eval√∫an las 4 dimensiones, se aplican penalizaciones (fiscales, omisi√≥n, viabilidad legal), 
                se calculan bonos (m√∫ltiples propuestas, calidad, financiamiento) y se generan flags informativos.
              </p>
            </div>
          </div>
          
          <div class="relative flex items-start gap-4">
            <div class="w-12 h-12 bg-slate-700 rounded-full flex items-center justify-center text-white font-bold z-10 shrink-0">6</div>
            <div class="bg-white border border-slate-200 rounded-xl p-4 flex-1 shadow-sm">
              <h4 class="font-bold text-slate-900">Generaci√≥n de JSON</h4>
              <p class="text-sm text-slate-600 mt-1">
                Se exportan los resultados a archivos JSON que consume el sitio web.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <hr />

    <h2>üìä Archivos de Datos Generados</h2>

    <div class="not-prose overflow-x-auto mt-4">
      <table class="min-w-full text-sm border border-slate-200">
        <thead>
          <tr class="bg-slate-50 border-b border-slate-200">
            <th class="text-left py-3 px-4">Archivo</th>
            <th class="text-left py-3 px-4">Descripci√≥n</th>
            <th class="text-right py-3 px-4">Tama√±o aprox.</th>
          </tr>
        </thead>
        <tbody>
          <tr class="border-b border-slate-100">
            <td class="py-3 px-4 font-mono text-sm">candidates.json</td>
            <td class="py-3 px-4 text-slate-600">Datos de candidatos y partidos (editado manualmente)</td>
            <td class="py-3 px-4 text-right">~5 KB</td>
          </tr>
          <tr class="border-b border-slate-100">
            <td class="py-3 px-4 font-mono text-sm">pillars.json</td>
            <td class="py-3 px-4 text-slate-600">Definici√≥n de los 10 pilares y pesos</td>
            <td class="py-3 px-4 text-right">~2 KB</td>
          </tr>
          <tr class="border-b border-slate-100">
            <td class="py-3 px-4 font-mono text-sm">proposals.json</td>
            <td class="py-3 px-4 text-slate-600">Todas las propuestas extra√≠das con evidencia</td>
            <td class="py-3 px-4 text-right">~150 KB</td>
          </tr>
          <tr class="border-b border-slate-100">
            <td class="py-3 px-4 font-mono text-sm">candidate_scores.json</td>
            <td class="py-3 px-4 text-slate-600">Puntajes por pilar y totales por candidato</td>
            <td class="py-3 px-4 text-right">~100 KB</td>
          </tr>
          <tr class="border-b border-slate-100">
            <td class="py-3 px-4 font-mono text-sm">ranking.json</td>
            <td class="py-3 px-4 text-slate-600">Rankings ordenados (general, prioritario, cr√≠tico)</td>
            <td class="py-3 px-4 text-right">~12 KB</td>
          </tr>
          <tr>
            <td class="py-3 px-4 font-mono text-sm">detailed_analysis.json</td>
            <td class="py-3 px-4 text-slate-600">An√°lisis detallado con fortalezas y debilidades</td>
            <td class="py-3 px-4 text-right">~50 KB</td>
          </tr>
        </tbody>
      </table>
    </div>

    <hr />

    <h2>üîß Ejecuci√≥n del An√°lisis</h2>

    <div class="not-prose bg-slate-900 rounded-xl p-5 mt-4 overflow-x-auto">
      <pre class="text-sm text-slate-100 font-mono"><code set:text={`# 1. Instalar dependencias
pip install PyMuPDF Pillow pytesseract

# 2. Instalar Tesseract (macOS)
brew install tesseract tesseract-lang

# 3. Ejecutar el an√°lisis v7
cd analysis/
python process_plans_v7.py

# Salida esperada:
# ================================================================================
# PROCESADOR DE PLANES v7.0 - NEUTRAL + ESTRICTO + BONOS + VIABILIDAD + FLAGS
# 10 pilares | OCR autom√°tico | Penalizaciones | Bonos | Viabilidad legal | Flags informativos
# ================================================================================
# üìÑ ACRM...
# üìÑ CAC...
# ...
# ‚úÖ PROCESO COMPLETADO`}></code></pre>
    </div>

    <hr />

    <h2>üìê Constantes de Penalizaci√≥n</h2>

    <div class="not-prose bg-slate-900 rounded-xl p-5 mt-4 overflow-x-auto">
      <pre class="text-sm text-slate-100 font-mono"><code set:text={`# Penalizaciones por irresponsabilidad (basadas en ley vigente)
FISCAL_PENALTIES = {
    "attacks_fiscal_rule": -2,      # Ataca la regla fiscal (Ley 9635)
    "proposes_debt_increase": -1,   # Propone m√°s deuda sin plan
}

# Penalizaciones por omisi√≥n (urgencias nacionales)
OMISSION_PENALTIES = {
    "ignores_security_operations": -1,    # No menciona seguridad operativa
    "ignores_ccss_crisis": -1,            # No menciona crisis CCSS
    "ignores_formal_employment": -0.5,    # No menciona empleo formal
    "ignores_organized_crime": -0.5,      # No menciona crimen organizado
    "missing_priority_pillar": -0.5,      # Por cada pilar prioritario faltante
}

# Penalizaciones por viabilidad legal (v7)
VIABILITY_PENALTIES = {
    "violates_separation_powers": -1.0,    # Viola separaci√≥n de poderes
    "violates_fundamental_rights": -1.0,    # Viola derechos fundamentales
    "violates_constitutional_guarantees": -1.0,  # Viola garant√≠as constitucionales
    "violates_constitutional_procedures": -0.5,  # Viola procedimientos constitucionales
}

# Bonos (v7)
BONUSES = {
    "multiple_proposals": 1.0,      # 3+ propuestas v√°lidas por pilar
    "complete_proposal": 0.25,      # Propuesta completa (4/4 dimensiones)
    "funding_clarity": 0.1,         # Propuesta con financiamiento claro (score >=3)
}

# Pilares prioritarios (P3=Seguridad, P4=Salud, P1=Fiscal, P7=Reforma)
PRIORITY_PILLARS = {"P3", "P4", "P1", "P7"}

# Pesos por pilar (v7)
PILLAR_WEIGHTS = {
    "P1": 0.14,  # Sostenibilidad fiscal
    "P2": 0.11,  # Empleo y competitividad
    "P3": 0.18,  # Seguridad ciudadana
    "P4": 0.16,  # Salud p√∫blica (CCSS)
    "P5": 0.10,  # Educaci√≥n
    "P6": 0.03,  # Ambiente
    "P7": 0.12,  # Reforma del Estado
    "P8": 0.05,  # Pol√≠tica social
    "P9": 0.02,  # Pol√≠tica exterior
    "P10": 0.09, # Infraestructura
}

# Flags Informativos (v7 - NO penalizan, solo informan)
INFORMATIVE_FLAGS = {
    "current_proposals": {
        "violates_separation_powers": "Viola separaci√≥n de poderes",
        "violates_fundamental_rights": "Viola derechos fundamentales",
        "violates_constitutional_guarantees": "Viola garant√≠as constitucionales",
        "violates_constitutional_procedures": "Viola procedimientos constitucionales",
    },
    "dictatorial_patterns": "Similitudes con modelos dictatoriales (Cuba, Venezuela)",
    "power_negotiation_requirements": "Requisitos de negociaci√≥n entre poderes",
    "historical": "Evidencia hist√≥rica verificable",
    "contradictions": "Contradicciones hist√≥rico-actual",
}`}></code></pre>
    </div>

    <hr />

    <h2>‚ÑπÔ∏è Flags Informativos (v7)</h2>

    <div class="not-prose space-y-4 mt-4">
      <div class="bg-blue-50 border border-blue-200 rounded-xl p-5">
        <h3 class="font-bold text-blue-900 mb-3">¬øQu√© son los Flags Informativos?</h3>
        <p class="text-slate-700 mb-3">
          Los <strong>flags informativos NO penalizan el score</strong>. Son se√±ales de informaci√≥n objetiva 
          basadas en evidencia verificable que ayudan al ciudadano a tomar decisiones m√°s informadas.
        </p>
        <div class="space-y-3">
          <div class="bg-white rounded-lg p-3">
            <p class="font-semibold text-slate-800 mb-1">1. Propuestas Actuales Problem√°ticas</p>
            <p class="text-sm text-slate-600">
              Detecta violaciones constitucionales en propuestas actuales (separaci√≥n de poderes, 
              derechos fundamentales, garant√≠as constitucionales, procedimientos).
            </p>
          </div>
          <div class="bg-white rounded-lg p-3">
            <p class="font-semibold text-slate-800 mb-1">2. Similitudes con Modelos Dictatoriales</p>
            <p class="text-sm text-slate-600">
              Detecta patrones objetivos similares a modelos hist√≥ricos (Cuba, Venezuela) basados 
              en evidencia verificable. NO juzga ideolog√≠a, solo detecta patrones de comportamiento.
            </p>
          </div>
          <div class="bg-white rounded-lg p-3">
            <p class="font-semibold text-slate-800 mb-1">3. Requisitos de Negociaci√≥n</p>
            <p class="text-sm text-slate-600">
              Indica complejidad de implementaci√≥n (requiere aprobaci√≥n de Asamblea, mayor√≠a calificada, 
              coordinaci√≥n entre poderes). NO es un problema, solo informa sobre complejidad.
            </p>
          </div>
          <div class="bg-white rounded-lg p-3">
            <p class="font-semibold text-slate-800 mb-1">4. Evidencia Hist√≥rica Verificable</p>
            <p class="text-sm text-slate-600">
              Muestra evidencia hist√≥rica verificable de comportamiento del candidato/partido basada en 
              sentencias judiciales, resoluciones internacionales, informes de Contralor√≠a.
            </p>
          </div>
          <div class="bg-white rounded-lg p-3">
            <p class="font-semibold text-slate-800 mb-1">5. Contradicciones Hist√≥rico-Actual</p>
            <p class="text-sm text-slate-600">
              Detecta patrones consistentes entre evidencia hist√≥rica y propuestas actuales problem√°ticas.
            </p>
          </div>
        </div>
        <div class="mt-4 bg-amber-50 border border-amber-200 rounded-lg p-3">
          <p class="text-sm text-amber-800">
            <strong>‚ö†Ô∏è Importante:</strong> Los flags informativos NO afectan el score. Son solo informaci√≥n 
            para que el ciudadano pueda tomar decisiones m√°s informadas.
          </p>
        </div>
      </div>
    </div>

    <hr />

    <div class="not-prose flex flex-col sm:flex-row gap-4 mt-8">
      <a href="/metodologia" class="flex-1 flex items-center justify-center gap-2 bg-civic-600 hover:bg-civic-700 text-white font-medium py-3 px-6 rounded-xl transition-colors">
        ‚Üê Volver a Metodolog√≠a
      </a>
      <a href="/ranking" class="flex-1 flex items-center justify-center gap-2 bg-slate-100 hover:bg-slate-200 text-slate-700 font-medium py-3 px-6 rounded-xl transition-colors">
        Ver Ranking ‚Üí
      </a>
    </div>

    <p class="text-sm text-slate-500 mt-12">
      <em>Motor de an√°lisis (Neutral + Estricto + Bonos + Viabilidad Legal + Flags Informativos) ¬∑ Enero 2026</em>
    </p>

  </article>
  </div>

  <!-- ============================================
       MODE: EXPRESS üöÄ
       ============================================ -->
  <div class="mode-express-content">
    <div class="express-tecnico-container">
      <h1 class="express-tecnico-title">‚öôÔ∏è Detalles T√©cnicos</h1>
      
      <div class="express-tech-card">
        <h2>üêç Stack</h2>
        <div class="express-tech-grid">
          <div class="express-tech-item">
            <span class="express-tech-icon">üêç</span>
            <strong>Python 3.10+</strong>
            <span>Scripts de procesamiento</span>
          </div>
          <div class="express-tech-item">
            <span class="express-tech-icon">üöÄ</span>
            <strong>Astro 4.x</strong>
            <span>Framework web</span>
          </div>
        </div>
      </div>

      <div class="express-tech-card">
        <h2>üìÑ Librer√≠as</h2>
        <div class="express-tech-list">
          <div class="express-tech-lib">
            <strong>PyMuPDF</strong>
            <code>pip install PyMuPDF</code>
          </div>
          <div class="express-tech-lib">
            <strong>Tesseract OCR</strong>
            <code>brew install tesseract</code>
          </div>
          <div class="express-tech-lib">
            <strong>Pillow</strong>
            <code>pip install Pillow</code>
          </div>
        </div>
      </div>

      <div class="express-tech-card">
        <h2>üîÑ Flujo</h2>
        <div class="express-flow">
          <div class="express-flow-step">1. Leer PDF</div>
          <div class="express-flow-step">2. Detectar corrupci√≥n</div>
          <div class="express-flow-step">3. Extraer texto (OCR si es necesario)</div>
          <div class="express-flow-step">4. Buscar propuestas</div>
          <div class="express-flow-step">5. Evaluar + Penalizar + Bonos</div>
          <div class="express-flow-step">6. Generar JSON</div>
        </div>
      </div>

      <div class="express-tech-card">
        <h2>üìê Constantes v7</h2>
        <div class="express-constants">
          <div class="express-constant-group">
            <strong>Penalizaciones Fiscales</strong>
            <span>Ataca regla: -2 | M√°s deuda: -1</span>
          </div>
          <div class="express-constant-group">
            <strong>Penalizaciones Omisi√≥n</strong>
            <span>Seguridad: -1 | CCSS: -1 | Empleo: -0.5</span>
          </div>
          <div class="express-constant-group">
            <strong>Viabilidad Legal</strong>
            <span>Separaci√≥n poderes: -1.0 | Derechos: -1.0</span>
          </div>
          <div class="express-constant-group">
            <strong>Bonos</strong>
            <span>M√∫ltiples: +1.0 | Completa: +0.25 | Financiamiento: +0.1</span>
          </div>
        </div>
      </div>

      <div class="express-tech-card">
        <h2>‚ÑπÔ∏è Flags Informativos</h2>
        <p class="express-flags-note">NO penalizan, solo informan:</p>
        <div class="express-flags-list">
          <span>‚ö†Ô∏è Propuestas problem√°ticas</span>
          <span>üìö Similitudes hist√≥ricas</span>
          <span>ü§ù Requisitos negociaci√≥n</span>
          <span>üìñ Evidencia hist√≥rica</span>
          <span>üîÑ Contradicciones</span>
        </div>
      </div>

      <p class="express-footer-note">
        Motor v7: Neutral + Estricto + Bonos + Viabilidad + Flags ¬∑ Enero 2026
      </p>
    </div>
  </div>

  <!-- ============================================
       MODE: READING üìñ
       ============================================ -->
  <div class="mode-reading-content">
    <article class="reading-tecnico-container">
      <h1 class="reading-main-title">‚öôÔ∏è Detalles T√©cnicos del An√°lisis</h1>
      
      <div class="reading-note-box">
        <p class="reading-large-text">
          Esta p√°gina est√° dirigida a personas con conocimientos t√©cnicos que deseen entender 
          c√≥mo funciona el sistema de an√°lisis. Si busca una explicaci√≥n m√°s general, 
          visite la <a href="/metodologia" class="reading-link">p√°gina de metodolog√≠a</a>.
        </p>
      </div>

      <section class="reading-section">
        <h2 class="reading-section-title">üêç Stack Tecnol√≥gico</h2>
        <p class="reading-medium-text">
          El sistema utiliza <strong>Python 3.10+</strong> para el procesamiento de documentos 
          y <strong>Astro 4.x</strong> como framework web para la visualizaci√≥n de resultados.
        </p>
      </section>

      <section class="reading-section">
        <h2 class="reading-section-title">üìÑ Procesamiento de PDFs</h2>
        <p class="reading-medium-text mb-4">
          El sistema utiliza las siguientes librer√≠as para procesar los documentos PDF:
        </p>
        
        <div class="reading-lib-item">
          <h3 class="reading-lib-title">PyMuPDF (fitz)</h3>
          <p class="reading-medium-text">
            Librer√≠a de alto rendimiento para lectura y manipulaci√≥n de documentos PDF. 
            Se utiliza para extraer texto p√°gina por p√°gina, detectar texto corrupto 
            (fuentes mal embebidas) y renderizar p√°ginas como im√°genes para OCR.
          </p>
          <code class="reading-code-block">pip install PyMuPDF</code>
        </div>

        <div class="reading-lib-item">
          <h3 class="reading-lib-title">Tesseract OCR</h3>
          <p class="reading-medium-text">
            Motor de reconocimiento √≥ptico de caracteres (OCR) de c√≥digo abierto, mantenido por Google. 
            Se utiliza para leer PDFs con texto corrupto o escaneado, y para extraer texto de im√°genes de p√°ginas.
          </p>
          <code class="reading-code-block">brew install tesseract tesseract-lang</code>
        </div>

        <div class="reading-lib-item">
          <h3 class="reading-lib-title">Pillow (PIL)</h3>
          <p class="reading-medium-text">
            Fork moderno de Python Imaging Library para manipulaci√≥n de im√°genes. 
            Se utiliza para convertir p√°ginas PDF a im√°genes PNG y preparar im√°genes para OCR.
          </p>
          <code class="reading-code-block">pip install Pillow</code>
        </div>
      </section>

      <section class="reading-section">
        <h2 class="reading-section-title">üîÑ Flujo de Procesamiento</h2>
        <p class="reading-medium-text mb-4">
          El sistema procesa los planes de gobierno en los siguientes pasos:
        </p>
        <ol class="reading-steps-list">
          <li class="reading-step-item">
            <strong>Lectura del PDF:</strong> Se abre el documento usando <code>fitz.open(pdf_path)</code>.
          </li>
          <li class="reading-step-item">
            <strong>Detecci√≥n de Texto Corrupto:</strong> Se muestrean las primeras 10 p√°ginas. 
            Si m√°s del 2% son caracteres de fuentes privadas, se activa OCR.
          </li>
          <li class="reading-step-item">
            <strong>Extracci√≥n de Texto:</strong> En modo normal se usa <code>page.get_text()</code>. 
            En modo OCR se renderiza a imagen y luego se procesa con Tesseract.
          </li>
          <li class="reading-step-item">
            <strong>B√∫squeda de Propuestas:</strong> Se buscan keywords por pilar y se extraen propuestas con contexto.
          </li>
          <li class="reading-step-item">
            <strong>Evaluaci√≥n, Penalizaci√≥n y Bonos:</strong> Se eval√∫an las 4 dimensiones, se aplican penalizaciones 
            (fiscales, omisi√≥n, viabilidad legal), se calculan bonos (m√∫ltiples propuestas, calidad, financiamiento) 
            y se generan flags informativos.
          </li>
          <li class="reading-step-item">
            <strong>Generaci√≥n de JSON:</strong> Se exportan los resultados a archivos JSON que consume el sitio web.
          </li>
        </ol>
      </section>

      <section class="reading-section">
        <h2 class="reading-section-title">üìê Constantes de Penalizaci√≥n y Bonos (v7)</h2>
        <p class="reading-medium-text mb-4">
          El sistema utiliza las siguientes constantes para calcular los puntajes:
        </p>
        
        <div class="reading-constants-box">
          <h3 class="reading-constants-title">Penalizaciones Fiscales</h3>
          <ul class="reading-constants-list">
            <li>Ataca regla fiscal: <strong>-2 puntos</strong></li>
            <li>Propone m√°s deuda sin plan: <strong>-1 punto</strong></li>
          </ul>
        </div>

        <div class="reading-constants-box">
          <h3 class="reading-constants-title">Penalizaciones por Omisi√≥n</h3>
          <ul class="reading-constants-list">
            <li>Ignora seguridad operativa: <strong>-1 punto</strong></li>
            <li>Ignora crisis CCSS: <strong>-1 punto</strong></li>
            <li>Ignora empleo formal: <strong>-0.5 puntos</strong></li>
            <li>Ignora crimen organizado: <strong>-0.5 puntos</strong></li>
            <li>Pilar prioritario faltante: <strong>-0.5 puntos</strong></li>
          </ul>
        </div>

        <div class="reading-constants-box">
          <h3 class="reading-constants-title">Penalizaciones por Viabilidad Legal</h3>
          <ul class="reading-constants-list">
            <li>Viola separaci√≥n de poderes: <strong>-1.0 puntos</strong></li>
            <li>Viola derechos fundamentales: <strong>-1.0 puntos</strong></li>
            <li>Viola garant√≠as constitucionales: <strong>-1.0 puntos</strong></li>
            <li>Viola procedimientos constitucionales: <strong>-0.5 puntos</strong></li>
          </ul>
        </div>

        <div class="reading-constants-box reading-constants-bonus">
          <h3 class="reading-constants-title">Bonos</h3>
          <ul class="reading-constants-list">
            <li>M√∫ltiples propuestas (3+ por pilar): <strong>+1.0 puntos</strong></li>
            <li>Propuesta completa (4/4 dimensiones): <strong>+0.25 puntos</strong></li>
            <li>Financiamiento claro (score >=3): <strong>+0.1 puntos</strong></li>
          </ul>
        </div>
      </section>

      <section class="reading-section">
        <h2 class="reading-section-title">‚ÑπÔ∏è Flags Informativos (v7)</h2>
        <p class="reading-large-text mb-4">
          Los <strong>flags informativos NO penalizan el score</strong>. Son se√±ales de informaci√≥n objetiva 
          basadas en evidencia verificable que ayudan al ciudadano a tomar decisiones m√°s informadas.
        </p>
        
        <div class="reading-flags-box">
          <h3 class="reading-flags-title">1. Propuestas Actuales Problem√°ticas</h3>
          <p class="reading-medium-text">
            Detecta violaciones constitucionales en propuestas actuales (separaci√≥n de poderes, 
            derechos fundamentales, garant√≠as constitucionales, procedimientos).
          </p>
        </div>

        <div class="reading-flags-box">
          <h3 class="reading-flags-title">2. Similitudes con Modelos Dictatoriales</h3>
          <p class="reading-medium-text">
            Detecta patrones objetivos similares a modelos hist√≥ricos (Cuba, Venezuela) basados 
            en evidencia verificable. NO juzga ideolog√≠a, solo detecta patrones de comportamiento.
          </p>
        </div>

        <div class="reading-flags-box">
          <h3 class="reading-flags-title">3. Requisitos de Negociaci√≥n</h3>
          <p class="reading-medium-text">
            Indica complejidad de implementaci√≥n (requiere aprobaci√≥n de Asamblea, mayor√≠a calificada, 
            coordinaci√≥n entre poderes). NO es un problema, solo informa sobre complejidad.
          </p>
        </div>

        <div class="reading-flags-box">
          <h3 class="reading-flags-title">4. Evidencia Hist√≥rica Verificable</h3>
          <p class="reading-medium-text">
            Muestra evidencia hist√≥rica verificable de comportamiento del candidato/partido basada en 
            sentencias judiciales, resoluciones internacionales, informes de Contralor√≠a.
          </p>
        </div>

        <div class="reading-flags-box">
          <h3 class="reading-flags-title">5. Contradicciones Hist√≥rico-Actual</h3>
          <p class="reading-medium-text">
            Detecta patrones consistentes entre evidencia hist√≥rica y propuestas actuales problem√°ticas.
          </p>
        </div>

        <div class="reading-warning-box">
          <p class="reading-medium-text">
            <strong>‚ö†Ô∏è Importante:</strong> Los flags informativos NO afectan el score. Son solo informaci√≥n 
            para que el ciudadano pueda tomar decisiones m√°s informadas.
          </p>
        </div>
      </section>

      <p class="reading-footer-note">
        Motor de an√°lisis (Neutral + Estricto + Bonos + Viabilidad Legal + Flags Informativos) ¬∑ Enero 2026
      </p>
    </article>
  </div>

</BaseLayout>

<style>
  /* ============================================
     MODE VISIBILITY
     ============================================ */
  .mode-dashboard-content { display: block; }
  .mode-express-content { display: none; }
  .mode-reading-content { display: none; }
  
  :global(html[data-mode="express"]) .mode-dashboard-content { display: none; }
  :global(html[data-mode="express"]) .mode-express-content { display: block; }
  :global(html[data-mode="express"]) .mode-reading-content { display: none; }
  
  :global(html[data-mode="reading"]) .mode-dashboard-content { display: none; }
  :global(html[data-mode="reading"]) .mode-express-content { display: none; }
  :global(html[data-mode="reading"]) .mode-reading-content { display: block; }

  /* ============================================
     MODE: DASHBOARD (default)
     ============================================ */
  .prose h2 {
    font-size: 1.5rem;
    font-weight: 700;
    color: #0f172a;
    margin-top: 3rem;
    margin-bottom: 1rem;
  }
  .prose p {
    color: #475569;
    line-height: 1.75;
  }
  .prose hr {
    margin: 2rem 0;
    border-color: #e2e8f0;
  }
  
  code {
    font-size: 0.875em;
  }

  /* ============================================
     MODE: EXPRESS üöÄ
     ============================================ */
  .express-tecnico-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem 1rem;
  }
  
  .express-tecnico-title {
    font-size: 2rem;
    font-weight: 800;
    color: #0f172a;
    margin-bottom: 2rem;
    text-align: center;
  }
  
  .express-tech-card {
    background: white;
    border-radius: 1rem;
    padding: 1.5rem;
    margin-bottom: 1.5rem;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
  }
  
  .express-tech-card h2 {
    font-size: 1.25rem;
    font-weight: 700;
    color: #0f172a;
    margin-bottom: 1rem;
  }
  
  .express-tech-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
  }
  
  .express-tech-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
    padding: 1rem;
    background: #f8fafc;
    border-radius: 0.75rem;
  }
  
  .express-tech-icon {
    font-size: 2rem;
  }
  
  .express-tech-item strong {
    font-size: 1rem;
    color: #1e293b;
  }
  
  .express-tech-item span {
    font-size: 0.875rem;
    color: #64748b;
  }
  
  .express-tech-list {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }
  
  .express-tech-lib {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    padding: 1rem;
    background: #f1f5f9;
    border-radius: 0.5rem;
  }
  
  .express-tech-lib strong {
    color: #1e293b;
  }
  
  .express-tech-lib code {
    background: #0f172a;
    color: #e2e8f0;
    padding: 0.5rem;
    border-radius: 0.25rem;
    font-size: 0.875rem;
  }
  
  .express-flow {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 0.75rem;
  }
  
  .express-flow-step {
    padding: 0.75rem;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border-radius: 0.5rem;
    text-align: center;
    font-size: 0.875rem;
    font-weight: 500;
  }
  
  .express-constants {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }
  
  .express-constant-group {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
    padding: 0.75rem;
    background: #f8fafc;
    border-radius: 0.5rem;
  }
  
  .express-constant-group strong {
    color: #1e293b;
    font-size: 0.875rem;
  }
  
  .express-constant-group span {
    color: #64748b;
    font-size: 0.75rem;
  }
  
  .express-flags-note {
    color: #64748b;
    font-size: 0.875rem;
    margin-bottom: 0.75rem;
  }
  
  .express-flags-list {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
  }
  
  .express-flags-list span {
    padding: 0.5rem 0.75rem;
    background: #dbeafe;
    color: #1e40af;
    border-radius: 0.5rem;
    font-size: 0.875rem;
  }
  
  .express-footer-note {
    text-align: center;
    color: #64748b;
    font-size: 0.875rem;
    margin-top: 2rem;
  }

  /* ============================================
     MODE: READING üìñ
     ============================================ */
  .reading-tecnico-container {
    max-width: 800px;
    margin: 0 auto;
    padding: 3rem 1.5rem;
    font-family: Georgia, serif;
  }
  
  .reading-main-title {
    font-size: 2.5rem;
    font-weight: 700;
    color: #1a1a1a;
    margin-bottom: 2rem;
    line-height: 1.2;
  }
  
  .reading-note-box {
    background: #f8fafc;
    border-left: 4px solid #3b82f6;
    padding: 1.5rem;
    margin-bottom: 3rem;
    border-radius: 0.5rem;
  }
  
  .reading-large-text {
    font-size: 1.25rem;
    line-height: 1.8;
    color: #1a1a1a;
  }
  
  .reading-medium-text {
    font-size: 1.125rem;
    line-height: 1.8;
    color: #374151;
  }
  
  .reading-link {
    color: #0066cc;
    text-decoration: underline;
  }
  
  .reading-section {
    margin-bottom: 3rem;
  }
  
  .reading-section-title {
    font-size: 1.75rem;
    font-weight: 700;
    color: #1a1a1a;
    margin-bottom: 1rem;
  }
  
  .reading-lib-item {
    margin-bottom: 2rem;
    padding-bottom: 2rem;
    border-bottom: 1px solid #e5e7eb;
  }
  
  .reading-lib-title {
    font-size: 1.5rem;
    font-weight: 600;
    color: #1a1a1a;
    margin-bottom: 0.75rem;
  }
  
  .reading-code-block {
    display: block;
    background: #1a1a1a;
    color: #e5e7eb;
    padding: 1rem;
    border-radius: 0.5rem;
    font-family: 'Courier New', monospace;
    font-size: 1rem;
    margin-top: 0.75rem;
    overflow-x: auto;
  }
  
  .reading-steps-list {
    list-style: decimal;
    padding-left: 2rem;
    margin-top: 1rem;
  }
  
  .reading-step-item {
    font-size: 1.125rem;
    line-height: 1.8;
    color: #374151;
    margin-bottom: 1rem;
  }
  
  .reading-step-item code {
    background: #f3f4f6;
    padding: 0.25rem 0.5rem;
    border-radius: 0.25rem;
    font-size: 0.9em;
  }
  
  .reading-constants-box {
    background: #f9fafb;
    border-left: 4px solid #3b82f6;
    padding: 1.5rem;
    margin-bottom: 1.5rem;
    border-radius: 0.5rem;
  }
  
  .reading-constants-box.reading-constants-bonus {
    border-left-color: #10b981;
    background: #f0fdf4;
  }
  
  .reading-constants-title {
    font-size: 1.25rem;
    font-weight: 600;
    color: #1a1a1a;
    margin-bottom: 0.75rem;
  }
  
  .reading-constants-list {
    list-style: disc;
    padding-left: 1.5rem;
    margin-top: 0.5rem;
  }
  
  .reading-constants-list li {
    font-size: 1.125rem;
    line-height: 1.8;
    color: #374151;
    margin-bottom: 0.5rem;
  }
  
  .reading-flags-box {
    background: #eff6ff;
    border-left: 4px solid #3b82f6;
    padding: 1.5rem;
    margin-bottom: 1.5rem;
    border-radius: 0.5rem;
  }
  
  .reading-flags-title {
    font-size: 1.25rem;
    font-weight: 600;
    color: #1a1a1a;
    margin-bottom: 0.75rem;
  }
  
  .reading-warning-box {
    background: #fef3c7;
    border-left: 4px solid #f59e0b;
    padding: 1.5rem;
    margin-top: 2rem;
    border-radius: 0.5rem;
  }
  
  .reading-footer-note {
    text-align: center;
    color: #6b7280;
    font-size: 1rem;
    font-style: italic;
    margin-top: 3rem;
    padding-top: 2rem;
    border-top: 1px solid #e5e7eb;
  }
</style>

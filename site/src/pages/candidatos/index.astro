---
import BaseLayout from '../../layouts/BaseLayout.astro';
import CandidateCard from '../../components/candidates/CandidateCard.astro';
import { candidates, scoresByCandidate, ranking } from '../../lib/data';

// Sort candidates by ranking
const sortedCandidates = [...candidates].sort((a, b) => {
  const scoreA = scoresByCandidate[a.candidate_id]?.overall.weighted_sum || 0;
  const scoreB = scoresByCandidate[b.candidate_id]?.overall.weighted_sum || 0;
  return scoreB - scoreA;
});
---

<BaseLayout title="Candidatos">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    
    <!-- Header -->
    <div class="mb-8">
      <h1 class="text-3xl font-bold text-slate-900 mb-2">Candidatos Presidenciales</h1>
      <p class="text-slate-600 max-w-3xl">
        {candidates.length} partidos con planes de gobierno registrados para las elecciones 2026-2030.
        Ordenados por puntaje ponderado general.
      </p>
    </div>

    <!-- Grid -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
      {sortedCandidates.map((candidate) => {
        const score = scoresByCandidate[candidate.candidate_id];
        if (!score) return null;
        
        return (
          <CandidateCard candidate={candidate} score={score} />
        );
      })}
    </div>

    <!-- CTA -->
    <div class="mt-12 text-center">
      <a href="/comparar" class="btn btn-primary py-3 px-8">
        Comparar candidatos
      </a>
    </div>

  </div>
</BaseLayout>
